<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
	<meta http-equiv="content-type" content="text/html; charset=utf-8"/>
	<title>Bash Scripters: Stop using subshells to call functions. ← Machinae Elegantiam</title>
	<meta name="author" content="Russell Harmon"/>

	

	<link rel="stylesheet" href="/css/reset.css" type="text/css"/>
	<link rel="stylesheet" href="/css/screen.css" type="text/css"/>
	<link rel="stylesheet" href="/css/960.css" type="text/css"/>
	<link rel="stylesheet" href="/css/syntax.css" type="text/css"/>

	<link rel="stylesheet" type="text/css" href="http://fonts.googleapis.com/css?family=Walter+Turncoat:regular"/>

	

	

	

	

	
	<meta name="keywords" content="machinae"/>
	

	<meta name="description" content="The personal website and blog of Russell Harmon"/>

	<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.5.0/jquery.min.js"></script>
	<script type="text/javascript" src="https://raw.github.com/gabrielfalcao/jquery-yql/master/jquery.yql.js"></script>
	<script type="text/javascript" src="https://raw.github.com/rmm5t/jquery-timeago/master/jquery.timeago.js"></script>

	
	
</head>
<body id="">
	<div id="site">
		<div id="header">
	<h1>
		<span class="nav">
			<a href="/machinae" title="A programming blog">Machinae Elegantiam</a>
			<span class="byline">← <a href="/">Russell Harmon</a></span>
		</span>
	</h1>
</div>
<div id="page"><p>When writing in bash, zsh, sh, etc&#8230; <strong>stop</strong> using subshells to call functions. There is a significant speed overhead to using a subshell and there is a much better alternative. Instead, you should just have a convention where a particular variable is always the return value of the function (I use <em>retval</em>). This has the added benefit of also allowing you to return arrays from your functions.</p>

<p>If you don&#8217;t know what a subshell is, a subshell is another bash shell which is spawned whenever you use <code>$()</code> or <code>` `</code> and is used to execute the code you put inside.</p>

<p>I did some simple testing to allow you to observe the overhead. For two functionally equivalent scripts:</p>

<p>This one uses a subshell:</p>

<p>This one uses a variable:</p>

<p>The speed difference between these two is noticeable and significant.</p>

<p>As you can see, when using <code>variable</code>, execution takes 0.367 seconds. <code>subshell</code> however takes a full 11.937 seconds!</p></div>

<!-- Disqus comment engine -->
<div id="disqus">
	<div id="disqus_thread"></div>
	<script type="text/javascript">
		var disqus_shortname = 'eatnumber1';
		
		var disqus_identifier = '/blog/2010-07-05/subshells';
		
		

		(function() {
			var dsq = document.createElement('script');
			dsq.type = 'text/javascript'; dsq.async = true;
			dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
			(document.getElementsByTagName('head')[0] ||
			 document.getElementsByTagName('body')[0]).appendChild(dsq);
		})();
	</script>
	<noscript>
		Please enable JavaScript to view the
		<a href="http://disqus.com/?ref_noscript">
			comments powered by Disqus.
		</a>
	</noscript>
	<a href="http://disqus.com" class="dsq-brlink">
		blog comments powered by
		<span class="logo-disqus">Disqus</span>
	</a>
</div>







		<div id="footer">
			<address>
				<span class="copyright">
					Content by <a rel="author" href="/">Russell Harmon</a>.
					Design by <a href="http://mark.reid.name/info/site.html">Mark Reid</a>
					<br/>
					(<a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/">Some rights reserved</a>)
				</span>
				<span class="engine">
					Powered by <a href="http://jekyllrb.com/" title="A static, minimalist CMS">Jekyll</a>.
					Hosted by <a href="http://pages.github.com/">GitHub</a>.
				</span>
			<address>
		</div>
	</div>

	
	<!-- Google Analytics -->
	<script type="text/javascript">
		var _gaq = _gaq || [];
		_gaq.push(['_setAccount', 'UA-10349264-2']);
		_gaq.push(['_trackPageview']);

		(function() {
			var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
			ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
			var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		})();
	</script>
	
</body>
</html>


