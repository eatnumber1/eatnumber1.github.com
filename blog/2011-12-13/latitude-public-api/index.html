<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"/><title>Getting Public Information From Latitude ← Machinae Elegantiam</title><meta name="author" content="Russell Harmon"/><link rel="stylesheet" href="/css/reset.css" type="text/css"/><link rel="stylesheet" href="/css/screen.css" type="text/css"/><link rel="stylesheet" href="/css/960.css" type="text/css"/><link rel="stylesheet" href="/css/syntax.css" type="text/css"/><link rel="stylesheet" type="text/css" href="http://fonts.googleapis.com/css?family=Walter+Turncoat:regular"/><meta name="keywords" content="machinae"/><meta name="description" content="Getting public information about a person from Latitude is no simple task. Google has no public API for retrieving non-authenticated information about a person."/><script src="https://ajax.googleapis.com/ajax/libs/jquery/1.5.0/jquery.min.js"></script><script src="/js/jquery.yql.js"></script><script src="/js/jquery.timeago.js"></script></head><body id=""><div id="site"><div id="header"><h1> <span class="nav"> <a href="/machinae" title="A programming blog">Machinae Elegantiam</a> <span class="byline">← <a href="/">Russell Harmon</a></span> </span></h1></div><div id="page"><p>In making this website, I wanted to put on my <a href='/#latitude'>homepage</a> my Google Latitude determined current location (at the statewide level). Google provides the <a href='http://code.google.com/apis/latitude/'>Latitude <abbr title='Application Programming Interface'>API</abbr></a>, but this is only for authenticated users, and therefore cannot be used by people wishing to publicly publish their location.</p><p>The Latitude website provides a location widget that can be placed on your website to show your current location, but it uses an undocumented <abbr title='Application Programming Interface'>API</abbr>. After a bit of effort reverse engineering the location widget, I eventually came up with the following <abbr title='Uniform Resource Locator'>URL</abbr>:</p><pre><code>http://www.google.com/latitude/apps/badge/api?user=4048757213362106746&amp;type=json</code></pre><p>This is an undocumented <abbr title='Application Programming Interface'>API</abbr> by Google, and notably cannot use <abbr title='JavaScript Object Notation'>JSON</abbr>P. That means that I couldn’t use that <abbr title='Uniform Resource Locator'>URL</abbr> directly from within my static-page <abbr title='A blog-aware, static site generator in Ruby'>Jekyll</abbr>-generated website thanks to the <a href='http://en.wikipedia.org/wiki/Same-origin_policy'>same origin policy</a>.</p><p>In order to work around this rather severe limitation, I leveraged the power of <a href='http://en.wikipedia.org/wiki/Yahoo!_query_language'><abbr title='Yahoo! query language'>YQL</abbr></a>, which is able to effectively turn a <abbr title='JavaScript Object Notation'>JSON</abbr>-only data source into a JSONP data source. At the end of the day, I’m able to retrieve my current location from Latitude by going through Yahoo with the following code:</p><div class='highlight'><pre><code class='javascript'><span class='kd'>function</span> <span class='nx'>doLatitude</span><span class='p'>(</span> <span class='nx'>id</span><span class='p'>,</span> <span class='nx'>elem</span> <span class='p'>)</span> <span class='p'>{</span>
  <span class='kd'>var</span> <span class='nx'>url</span> <span class='o'>=</span> <span class='s2'>"http://www.google.com/latitude/apps/badge/api"</span><span class='p'>;</span>
  <span class='kd'>var</span> <span class='nx'>data</span> <span class='o'>=</span> <span class='nx'>$</span><span class='p'>.</span><span class='nx'>param</span><span class='p'>({</span>
    <span class='nx'>user</span><span class='o'>:</span> <span class='nx'>id</span><span class='p'>,</span>
    <span class='nx'>type</span><span class='o'>:</span> <span class='s2'>"json"</span>
  <span class='p'>});</span>
  <span class='kd'>var</span> <span class='nx'>full_url</span> <span class='o'>=</span> <span class='nx'>url</span> <span class='o'>+</span> <span class='s2'>"?"</span> <span class='o'>+</span> <span class='nx'>data</span><span class='p'>;</span>
  <span class='nx'>$</span><span class='p'>.</span><span class='nx'>ajax</span><span class='p'>({</span>
    <span class='nx'>url</span><span class='o'>:</span> <span class='s2'>"http://query.yahooapis.com/v1/public/yql"</span><span class='p'>,</span>
    <span class='nx'>dataType</span><span class='o'>:</span> <span class='s2'>"jsonp"</span><span class='p'>,</span>
    <span class='nx'>data</span><span class='o'>:</span> <span class='p'>{</span>
      <span class='nx'>q</span><span class='o'>:</span> <span class='s2'>"SELECT * FROM json WHERE url='"</span> <span class='o'>+</span> <span class='nx'>full_url</span> <span class='o'>+</span> <span class='s2'>"'"</span><span class='p'>,</span>
      <span class='nx'>format</span><span class='o'>:</span> <span class='s2'>"json"</span>
    <span class='p'>},</span>
    <span class='nx'>success</span><span class='o'>:</span> <span class='kd'>function</span><span class='p'>(</span> <span class='nx'>data</span> <span class='p'>)</span> <span class='p'>{</span>
      <span class='k'>if</span><span class='p'>(</span> <span class='nx'>data</span><span class='p'>.</span><span class='nx'>query</span><span class='p'>.</span><span class='nx'>results</span><span class='p'>.</span><span class='nx'>json</span><span class='p'>.</span><span class='nx'>features</span> <span class='o'>==</span> <span class='kc'>null</span> <span class='p'>)</span> <span class='p'>{</span>
        <span class='nx'>elem</span><span class='p'>.</span><span class='nx'>html</span><span class='p'>(</span><span class='s2'>"&lt;span style=\"font-style:italic\"&gt;location unavailable&lt;/span&gt;"</span><span class='p'>);</span>
      <span class='p'>}</span> <span class='k'>else</span> <span class='p'>{</span>
        <span class='nx'>elem</span><span class='p'>.</span><span class='nx'>html</span><span class='p'>(</span><span class='nx'>data</span><span class='p'>.</span><span class='nx'>query</span><span class='p'>.</span><span class='nx'>results</span><span class='p'>.</span><span class='nx'>json</span><span class='p'>.</span><span class='nx'>features</span><span class='p'>.</span><span class='nx'>properties</span><span class='p'>.</span><span class='nx'>reverseGeocode</span><span class='p'>);</span>
      <span class='p'>}</span>
    <span class='p'>},</span>
    <span class='nx'>error</span><span class='o'>:</span> <span class='kd'>function</span><span class='p'>(</span> <span class='nx'>_</span><span class='p'>,</span> <span class='nx'>textStatus</span><span class='p'>,</span> <span class='nx'>errorThrown</span> <span class='p'>)</span> <span class='p'>{</span>
        <span class='nx'>elem</span><span class='p'>.</span><span class='nx'>replaceWith</span><span class='p'>(</span><span class='nx'>textStatus</span> <span class='o'>+</span> <span class='s2'>": "</span> <span class='o'>+</span> <span class='nx'>errorThrown</span><span class='p'>);</span>
    <span class='p'>}</span>
  <span class='p'>});</span>
<span class='p'>}</span>
</code></pre></div></div><div id="disqus"><div id="disqus_thread"></div> <script>var disqus_shortname="eatnumber1",disqus_identifier="/blog/2011-12-13/latitude-public-api";!function(){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src="http://"+disqus_shortname+".disqus.com/embed.js",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(e)}()</script><noscript> Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript"> comments powered by Disqus. </a> </noscript> <a href="http://disqus.com" class="dsq-brlink"> blog comments powered by <span class="logo-disqus">Disqus</span> </a></div><div id="footer"> <address> <span class="copyright"> Content by <a rel="author" href="/">Russell Harmon</a>. Design by <a href="http://mark.reid.name/info/site.html">Mark Reid</a> <br/> (<a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/">Some rights reserved</a>) </span> <span class="engine"> Powered by <a href="http://jekyllrb.com/" title="A static, minimalist CMS">Jekyll</a>. Hosted by <a href="http://pages.github.com/">GitHub</a>. </span> <address></div></div> <script>var _gaq=_gaq||[];_gaq.push(["_setAccount","UA-10349264-2"]),_gaq.push(["_trackPageview"]),function(){var t=document.createElement("script");t.type="text/javascript",t.async=!0,t.src=("https:"==document.location.protocol?"https://ssl":"http://www")+".google-analytics.com/ga.js";var e=document.getElementsByTagName("script")[0];e.parentNode.insertBefore(t,e)}()</script></body></html>